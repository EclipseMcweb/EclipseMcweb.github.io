<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>MediaMC Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;font-family:'Segoe UI',Arial;
  background:linear-gradient(135deg,#0ea5e9,#020617);
  color:#fff
}
header{
  display:flex;
  justify-content:flex-start;
  align-items:center;
  gap:10px;
  padding:10px 20px;
  background:rgba(2,6,23,.9)
}
#playerBox{
  display:flex;
  align-items:center;
  gap:8px;
  padding:6px 10px;
  border:1px solid #38bdf8;
  border-radius:8px;
  background:rgba(2,6,23,.7)
}
#logout{
  background:#1e3a8a;
  border:none;
  color:#fff;
  padding:4px 8px;
  border-radius:6px;
  cursor:pointer
}
#cartBtn{
  position:fixed;
  top:15px;
  right:20px;
  background:#38bdf8;
  border:none;
  padding:8px 12px;
  border-radius:8px;
  cursor:pointer
}
.container{max-width:1100px;margin:auto;padding:30px}
.box{
  background:rgba(2,6,23,.8);
  border:2px solid #38bdf8;
  border-radius:12px;
  padding:15px;
  margin-bottom:20px
}
.categories{display:flex;gap:12px;flex-wrap:wrap}
.cat{
  padding:8px 14px;
  border:1px solid #38bdf8;
  border-radius:8px;
  cursor:pointer
}
.products{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:15px
}
.product{
  border:1px solid #38bdf8;
  border-radius:10px;
  padding:10px;
  cursor:pointer
}
.modalBg{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.75);
  justify-content:center;
  align-items:center;
  z-index:999
}
.modal{
  background:#020617;
  border:2px solid #38bdf8;
  border-radius:12px;
  padding:20px;
  max-width:400px;
  width:90%
}
button{cursor:pointer}
</style>
</head>
<body>

<header>
  <div id="playerBox" style="display:none">
    <span id="nickTxt"></span>
    <button id="logout">Logout</button>
  </div>
</header>

<button id="cartBtn" onclick="location.href='cart.html'">üõí Carrello</button>

<div class="container" id="store" style="display:none">
  <div class="box">
    <h2>Categorie</h2>
    <div class="categories" id="cats"></div>
  </div>

  <div class="box">
    <h2>Prodotti</h2>
    <div class="products" id="products"></div>
  </div>

  <div style="text-align:center;margin-top:40px">
    <button onclick="location.href='staff.html'">‚öôÔ∏è Pannello Staff</button>
  </div>
</div>

<!-- MODAL NICK -->
<div class="modalBg" id="nickModal">
  <div class="modal">
    <h2>Inserisci il tuo nick Minecraft</h2>
    <input id="nickInput" placeholder="Nick Minecraft" style="width:100%;padding:8px">
    <br><br>
    <button onclick="enter()">Entra</button>
  </div>
</div>

<!-- MODAL PRODOTTO -->
<div class="modalBg" id="prodModal">
  <div class="modal">
    <h2 id="mTitle"></h2>
    <p id="mDesc"></p>
    <p><b>Prezzo:</b> ‚Ç¨<span id="mPrice"></span></p>
    <button onclick="addToCart()">Aggiungi al carrello</button>
    <button onclick="closeProd()">Chiudi</button>
  </div>
</div>

<script>
let nick=sessionStorage.getItem('nick');
let currentProd=null;

if(!nick){
  document.getElementById('nickModal').style.display='flex';
}else init();

function enter(){
  nick=document.getElementById('nickInput').value.trim();
  if(!nick) return alert("Inserisci nick");
  sessionStorage.setItem('nick',nick);
  init();
}

function init(){
  document.getElementById('nickModal').style.display='none';
  document.getElementById('store').style.display='block';
  document.getElementById('playerBox').style.display='flex';
  document.getElementById('nickTxt').textContent=nick;
  loadCats();
}

document.getElementById('logout').onclick=()=>{
  sessionStorage.clear();
  location.reload();
}

function loadCats(){
  const cats=JSON.parse(localStorage.getItem('categories'))||[];
  const c=document.getElementById('cats');
  c.innerHTML='';
  document.getElementById('products').innerHTML='';
  cats.forEach(cat=>{
    const d=document.createElement('div');
    d.className='cat';
    d.textContent=cat;
    d.onclick=()=>show(cat);
    c.appendChild(d);
  });
}

function show(cat){
  const prods=JSON.parse(localStorage.getItem('products'))||[];
  const p=document.getElementById('products');
  p.innerHTML='';
  prods.filter(x=>x.category===cat).forEach(pr=>{
    const d=document.createElement('div');
    d.className='product';
    d.innerHTML=`<b>${pr.name}</b><br>‚Ç¨${pr.price}`;
    d.oncontextmenu=e=>{
      e.preventDefault();
      openProd(pr);
    }
    d.onclick=()=>openProd(pr);
    p.appendChild(d);
  });
}

function openProd(p){
  currentProd=p;
  document.getElementById('mTitle').textContent=p.name;
  document.getElementById('mDesc').textContent=p.desc||'';
  document.getElementById('mPrice').textContent=p.price;
  document.getElementById('prodModal').style.display='flex';
}
function closeProd(){
  document.getElementById('prodModal').style.display='none';
}

function addToCart(){
  let cart=JSON.parse(localStorage.getItem('cart_'+nick))||[];
  cart.push(currentProd);
  localStorage.setItem('cart_'+nick,JSON.stringify(cart));
  alert("Aggiunto al carrello");
  closeProd();
}
</script>
</body>
</html>
