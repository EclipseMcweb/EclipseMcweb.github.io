<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>MediaMC Staff Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:'Segoe UI',Arial;background:linear-gradient(135deg,#0ea5e9,#1e3a8a);color:#fff}
header{text-align:center;padding:40px;background:rgba(2,6,23,.9)}
section{max-width:900px;margin:30px auto;background:rgba(30,64,175,.85);padding:20px;border-radius:12px;border:2px solid #38bdf8}
button{background:#38bdf8;border:none;border-radius:6px;padding:6px 12px;color:#fff;font-weight:bold;cursor:pointer;margin:5px 0}
button.red{background:#ef4444}
input,select{padding:6px;border-radius:6px;border:none;width:90%;margin-bottom:10px}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center}
.modalBox{background:#020617;padding:20px;border-radius:12px;border:2px solid #38bdf8;text-align:center}
.hidden{display:none}
.productItem{display:flex;justify-content:space-between;background:rgba(2,6,23,.8);padding:8px;border-radius:6px;margin:5px 0}
</style>
</head>
<body>

<div id="loginModal" class="modal">
  <div class="modalBox">
    <h2>üîí Login Staff</h2>
    <input id="passInput" type="password" placeholder="Inserisci password">
    <br><br>
    <button onclick="checkLogin()">Accedi</button>
  </div>
</div>

<header>
<h1>‚öôÔ∏è Pannello Staff MediaMC</h1>
</header>

<section id="staffPanel" class="hidden">

<h2>Categorie</h2>
<input id="catInput" placeholder="Nuova Categoria">
<button onclick="addCategory()">Aggiungi Categoria</button>
<div id="catList"></div>

<h2>Prodotti</h2>
<select id="catSelect"></select>
<input id="prodName" placeholder="Nome Prodotto">
<input id="prodPrice" type="number" placeholder="Prezzo">
<input id="prodDesc" placeholder="Descrizione">
<input id="prodImg" placeholder="URL Immagine">
<button onclick="addProduct()">Crea Prodotto</button>
<div id="prodList"></div>

<h2>GiftCard</h2>
<button onclick="openGiftModal()">Crea GiftCard</button>
<div id="giftList"></div>

<h2>Ricerca Ordine</h2>
<input id="orderSearch" placeholder="ID Ordine">
<button onclick="searchOrder()">Cerca</button>
<div id="orderResult"></div>

</section>

<div id="giftModal" class="modal hidden">
  <div class="modalBox">
    <h2>Crea GiftCard</h2>
    <input id="giftCode" placeholder="Codice GiftCard">
    <input id="giftValue" type="number" placeholder="Valore ‚Ç¨">
    <br>
    <button onclick="createGift()">Crea</button>
    <button onclick="closeGiftModal()">Chiudi</button>
  </div>
</div>

<script>
// login
function checkLogin(){
  const p=document.getElementById('passInput').value;
  if(p==='staff123'){
    localStorage.setItem('staffLogged','true');
    document.getElementById('loginModal').classList.add('hidden');
    document.getElementById('staffPanel').classList.remove('hidden');
    initStaff();
  } else alert('Password errata');
}

if(localStorage.getItem('staffLogged')==='true'){
  document.getElementById('loginModal').classList.add('hidden');
  document.getElementById('staffPanel').classList.remove('hidden');
  initStaff();
}

// categories
let categories=JSON.parse(localStorage.getItem('categories'))||['BedWars','Duels','Survival'];
let products=JSON.parse(localStorage.getItem('products'))||[];
let giftCards=JSON.parse(localStorage.getItem('giftCards'))||[];

function initStaff(){
  renderCategories();
  renderProducts();
  renderGiftCards();
}

// Categorie
function addCategory(){
  const c=document.getElementById('catInput').value.trim();
  if(!c) return;
  if(!categories.includes(c)) categories.push(c);
  localStorage.setItem('categories',JSON.stringify(categories));
  document.getElementById('catInput').value='';
  renderCategories();
  renderCatSelect();
}

function renderCategories(){
  const div=document.getElementById('catList');
  div.innerHTML=categories.map(c=>`<div>${c}</div>`).join('');
  renderCatSelect();
}

function renderCatSelect(){
  const sel=document.getElementById('catSelect');
  sel.innerHTML='';
  categories.forEach(c=>{
    const o=document.createElement('option');
    o.value=c;o.textContent=c;
    sel.appendChild(o);
  });
}

// Prodotti
function addProduct(){
  const cat=document.getElementById('catSelect').value;
  const name=document.getElementById('prodName').value.trim();
  const price=parseFloat(document.getElementById('prodPrice').value);
  const desc=document.getElementById('prodDesc').value.trim();
  const img=document.getElementById('prodImg').value.trim();
  if(!name||isNaN(price)) return alert('Inserisci nome e prezzo');
  products.push({category:cat,name,price,desc,img});
  localStorage.setItem('products',JSON.stringify(products));
  document.getElementById('prodName').value='';
  document.getElementById('prodPrice').value='';
  document.getElementById('prodDesc').value='';
  document.getElementById('prodImg').value='';
  renderProducts();
}

function renderProducts(){
  const div=document.getElementById('prodList');
  div.innerHTML='';
  products.forEach((p,idx)=>{
    const d=document.createElement('div');
    d.className='productItem';
    d.innerHTML=`${p.name} (${p.category}) ‚Ç¨${p.price} <button class="red" onclick="removeProduct(${idx})">X</button>`;
    div.appendChild(d);
  });
}

function removeProduct(idx){
  products.splice(idx,1);
  localStorage.setItem('products',JSON.stringify(products));
  renderProducts();
}

// GiftCard
function openGiftModal(){document.getElementById('giftModal').classList.remove('hidden')}
function closeGiftModal(){document.getElementById('giftModal').classList.add('hidden')}
function createGift(){
  const code=document.getElementById('giftCode').value.trim().toUpperCase();
  const value=parseFloat(document.getElementById('giftValue').value);
  if(!code||isNaN(value)) return alert('Inserisci codice e valore');
  giftCards.push({code,value,used:false});
  localStorage.setItem('giftCards',JSON.stringify(giftCards));
  document.getElementById('giftCode').value='';
  document.getElementById('giftValue').value='';
  renderGiftCards();
  closeGiftModal();
}

function renderGiftCards(){
  const div=document.getElementById('giftList');
  div.innerHTML='';
  giftCards.forEach((g,idx)=>{
    const d=document.createElement('div');
    d.className='productItem';
    d.innerHTML=`${g.code} ‚Ç¨${g.value} - ${g.used?'Usata':'Attiva'} <button class="red" onclick="removeGift(${idx})">X</button>`;
    div.appendChild(d);
  });
}

function removeGift(idx){
  giftCards.splice(idx,1);
  localStorage.setItem('giftCards',JSON.stringify(giftCards));
  renderGiftCards();
}

// Ricerca ordini
function searchOrder(){
  const id=document.getElementById('orderSearch').value.trim();
  const data=JSON.parse(localStorage.getItem('checkoutData'))||{};
  const res=document.getElementById('orderResult');
  if(data.id===id){
    const items=data.cart.map(p=>`${p.name} ‚Ç¨${p.price}`).join(', ');
    res.innerHTML=`<p><strong>Nick:</strong> ${data.nick}<br><strong>Prodotti:</strong> ${items}<br><strong>Totale:</strong> ‚Ç¨${data.total}</p>`;
  } else res.textContent='Ordine non trovato';
}
</script>

</body>
</html>
